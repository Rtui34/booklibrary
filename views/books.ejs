<!DOCTYPE html>
<html>
<head>
  <title>Books</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div class="container">
    <h1>My Book Library</h1>
    <a href="/logout" class="btn logout">Logout</a>
    <a href="/books/create" class="btn">+ Add Book</a>

    <form method="GET" class="search-form">
      <input name="author" placeholder="Author" value="<%= query.author || '' %>">
      <select name="genre">
        <option value="">All Genres</option>
        <option value="Fiction" <%= query.genre==='Fiction' ? 'selected':'' %>>Fiction</option>
        <option value="Science" <%= query.genre==='Science' ? 'selected':'' %>>Science</option>
        <option value="History" <%= query.genre==='History' ? 'selected':'' %>>History</option>
      </select>
      <input name="year" type="number" placeholder="Year" value="<%= query.year || '' %>">
      <button>Search</button>
    </form>

    <table>
      <tr><th>Title</th><th>Author</th><th>Year</th><th>Genre</th><th>Actions</th></tr>
      <% books.forEach(book => { %>
        <tr>
          <td><%= book.title %></td>
          <td><%= book.author %></td>
          <td><%= book.year %></td>
          <td><%= book.genre %></td>
          <td>
            <a href="/books/edit/<%= book._id %>">Edit</a>
            <form method="POST" action="/books/delete/<%= book._id %>" style="display:inline">
              <button type="submit" onclick="return confirm('Delete?')" class="delete">Delete</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </table>
  </div>
</body>
</html>
